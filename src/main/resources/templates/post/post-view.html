<!DOCTYPE HTML>
<html land="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:replace="fragment.html :: commonHead"></th:block>
    <link rel="stylesheet" href="/library/tagify/dist/tagify.css">
    <style>
        /* 데스크탑*/
        @media (min-width: 992px) {
            #postView{
                margin-top: 100px;
            }
            #postTitle{
                padding: 24px 38px;
            }
            #postViewTable{
                margin-bottom: 42px;
            }
            #postContent{
                padding: 30px 50px;
            }
            #modifyButton{
                width: 270px;
                margin-right: 59px;
            }
            #deleteButton{
                width: 270px;
            }
        }

        /* 태블릿 */
        @media (min-width: 576px) and (max-width: 991.98px) {
            #postView{
                margin-top: 74px
            }
            #postTitle{
                padding: 24px 38px;
            }
            #postViewTable{
                margin-bottom: 42px;
            }
            #postContent{
                padding: 30px 50px;
            }
            #modifyButton{
                width: 236px;
                margin-right: 42px;
            }
            #deleteButton{
                width: 236px;
            }
        }

        /* 핸드폰 일반 */
        @media (max-width: 575.98px) and (max-width: 340px){
            #postView{
                margin-top: 43px;
            }
            #postTitle{
                padding: 14px 17px;
            }
            #postViewTable{
                margin-bottom: 23px;
            }
            .tableTitle{
                width: 82px;
            }
            #postContent{
                padding: 26px 28px;
            }
            #modifyButton{
                width: 138px;
                margin-right: 19px;
            }
            #deleteButton{
                width: 138px;
            }

            /* 초소형 핸드폰 */
            @media (max-width: 575.98px) and (max-width: 340px){
                #postView{
                    margin-top: 43px;
                }
                #postTitle{
                    padding: 14px 17px;
                }
                #postViewTable{
                    margin-bottom: 23px;
                }
                .tableTitle{
                    width: 82px;
                }
                #postContent{
                    padding: 26px 28px;
                }
                #modifyButton{
                    width: 121px;
                    margin-right: 18px;
                }
                #deleteButton{
                    width: 121px;
                }
        }
    </style>
</head>
<body>

<div th:replace="fragment.html :: commonNav"></div>

<div class="container">

    <div id="postView">
        <table id="postViewTable" class="table table-bordered mx-auto col-lg-7 col-md-10 col-12">
            <tbody>
            <tr>
                <td id="postTitle" colspan="2" th:text="${post.getTitle()}">
                    글 제목
                </td>
            </tr>
            <tr style="text-align: center">
                <td class="tableTitle"><span>작성자 : </span></td>
                <td style="vertical-align: middle">
                    <a th:href="@{'/account/profile-view/' + ${post.getAuthor().getUserId()}}" th:text="${post.getAuthor().getNickname() + ' (' + post.getAuthor().getUserId() + ')'}">
                        작성자 닉네임(작성자 아이디)
                    </a>
                </td>
            </tr>
            <tr style="text-align: center">
                <td class="tableTitle"><span>작성일 : </span></td><td style="vertical-align: middle" class="date-weekday-time" th:text="${firstWrittenTime}">글 작성 날짜</td>
            </tr>
            <tr style="text-align: center">
                <td class="tableTitle" style="vertical-align: middle"><span>태그 : </span></td>
                <td style="vertical-align: middle"><input name="tag" readonly th:value="${#strings.listJoin(tagOnPost, ',')}"></td>
            </tr>
            <tr>
                <td id="postContent" colspan="2" th:utext="${post.getContent()}">글 내용</td>
            </tr>
            </tbody>
        </table>

        <div class="text-center mx-auto">
            <a id="modifyButton" th:if="${isAuthor}" class="btn btn-primary" th:href="@{'/post-update/' + ${post.getId()}}">수정하기</a>
            <!-- Button trigger modal -->
            <button id="deleteButton" th:if="${isAuthor}" type="button" class="btn btn-danger" onclick="show_delete_confirm_modal()" data-toggle="modal" data-target="#postDeleteModal">
                삭제하기
            </button>
        </div>

        <form id="delete-form" th:if="${isAuthor}" th:action="@{'/post-delete'}" th:object="${postDeleteRequestDto}" method="post" novalidate>
            <input type="hidden" th:field="*{postIdToDelete}">
        </form>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="postDeleteModal" tabindex="-1" role="dialog" aria-labelledby="postDeleteModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="postDeleteModalLabel">게시글 삭제</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    게시글을 삭제하시겠습니까?
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" onclick="delete_submit_func()">삭제</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">취소</button>
                </div>
            </div>
        </div>
    </div>

</div>
<footer th:replace="fragment.html :: commonFooter"></footer>
<script th:replace="fragment.html :: commonJavaScript"></script>
<script src="/library/tagify/dist/tagify.min.js"></script>
<script th:replace="fragment.html :: date-time"></script>
<script type="application/javascript">
    const input = document.querySelector('input[name=tag]');
    tagify = new Tagify(input);

    function show_delete_confirm_modal(){
        $('#postDeleteModal').modal("show");
    }

    function delete_submit_func(){
        document.getElementById('delete-form').submit();
    }
</script>
</body>
</html>