<!doctype html>
<html land="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">


<th:block th:fragment="commonHead">
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Common CSS -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/library/bootstrap/bootstrap.min.css" />
    <link rel="stylesheet" href="/library/fontawesome/css/all.min.css">
    <style>
        .container{
            max-width: 100%;
            padding: 0;
        }
        /* 오직 데스크탑만 */
        @media (min-width: 992px) {
            #userIconImage{
                margin: auto;
                width: 57px;
                height: 57px;
            }
            .modal{
                margin-top: 79px;
            }
            #userIcon{
                margin-right: 42px;
            }
            #mainSearchButton{
                margin-left: 16px !important;
            }
            #brandTitle{
                margin-left: 24px !important;
            }
        }

        /* 태블릿, 핸드폰 */
        @media (max-width: 991.98px){
            #brandTitle{
                margin-left: 1px;
            }
            #userIcon{
                text-align: center;
            }
            #userIconImage{
                margin-left: auto;
                margin-right: auto;
                margin-bottom: 7px;
                width: 90px;
                height: 90px;
            }
            #notificationBellOuter{
                text-align: center;
                height: 76px;
            }
            #ringBellFont{
                margin: auto;
            }
        }

        /* 오직 태블릿만 */
        @media (min-width: 576px) and (max-width: 991.98px) {
            .modal{
                margin-top: 83px;
            }
            #brandTitle {
                margin-left: 16px !important;
            }
            #mainNavBar{
                padding-top: 20px;
            }
            #navbarSupportedContent{
                margin-top: 10px !important;
            }
            #postNewPostButton{
                width: 272px;
                margin: auto;
            }
            #mainSearchForm{
                justify-content: center;
            }
            #userDropdownMenu{
                margin-left: auto;
                margin-right: auto;
                width: 191px;
                font-size: 18px;
            }
            #notificationBellOuter{
                padding-bottom: 13px;
            }
            #mainLogInButton{
                margin-top: 6px;
                margin-bottom: 1px;
            }
            #mainSignUpLink{
                padding: 0;
            }
            #mainSearchForm{
                margin-top: 17px;
                margin-bottom: 15px;
            }
            #emailVerificationAlertMessage{
                font-size: 15px;
            }
            #mainSearchButton{
                margin-left: 16px !important;
            }
        }

        /* 오직 핸드폰만 */
        @media (max-width: 575.98px) {
            .modal{
                margin-top: 65px;
            }
            .modal-dialog{
                width: 90% !important;
                margin-left: auto;
                margin-right: auto;
            }
            #brandTitle {
                margin-left: 16px !important;
            }
            #mainNavBar{
                padding-top: 20px;
            }
            #navbarSupportedContent{
                margin-top: 10px !important;
            }
            #notificationBellOuter{
                padding-bottom: 13px;
            }
            #postNewPostButton{
                width: 100%;
            }
            #mainSearchButton{
                width: 100%;
                margin-top: 17px;
                margin-bottom: 15px;
            }
            #userDropdownMenu{
                margin-left: auto;
                margin-right: auto;
                width: 178px;
                font-size: 17px;
            }
            #mainLogInButton{
                margin-top: 6px;
                margin-bottom: 1px;
            }
            #mainSignUpLink{
                padding: 0;
            }
            #mainSearchForm{
                margin-top: 17px;
                margin-bottom: 15px;
            }
        }

        #userIdOfUserIcon, #userNicknameOfUserIcon{
            text-align: left;
            overflow:hidden;
            word-wrap:break-word;
        }
    </style>
    <title>TH</title>
</th:block>

<div th:fragment="commonNav">
    <nav id="mainNavBar" class="navbar navbar-expand-lg navbar-light bg-light">
        <h1><a id="brandTitle" class="navbar-brand" th:href="@{/}" style="font-size: 33px">TH</a></h1>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse flex-row-reverse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-0">
                <li id="mainLogInButton" class="nav-item active mr-lg-4 d-flex align-items-center justify-content-center" sec:authorize="!isAuthenticated()">
                    <a class="nav-link " th:href="@{/login}">로그인</a>
                </li>
                <li id="mainSignUpButton" class="nav-item active mr-lg-5 d-flex align-items-center justify-content-center" sec:authorize="!isAuthenticated()">
                    <a id="mainSignUpLink" class="nav-link" th:href="@{/sign-up}">회원가입</a>
                </li>
                <li class="nav-item active mr-lg-5  d-flex align-items-center order-lg-2 order-md-3 order-3" sec:authorize="isAuthenticated()">
                    <a id="postNewPostButton"  class="nav-link btn btn-outline-info p-2" th:href="@{/post-new-post}">게시글 작성</a>
                </li>
                <li id="notificationBellOuter" class="nav-item active mr-lg-5 d-flex align-items-center order-lg-3 order-md-2 order-2" sec:authorize="isAuthenticated()">
                        <i id="ringBellFont" class="far fa-bell fa-lg text-dark" style="font-size: 29px"></i>
                </li>
                <li id="userIcon" class="nav-item dropdown order-lg-4 order-md-1 order-1"  sec:authorize="isAuthenticated()">
                    <a class="nav-link dropdown-toggle p-0" href="#" id="userIconImage" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <svg th:if="${#strings.isEmpty(sessionAccount?.profileImage)}" th:data-jdenticon-value="${#authentication.name}"
                             width="100%" height="100%" class="rounded border bg-light"></svg>
                        <img th:if="${!#strings.isEmpty(sessionAccount?.profileImage)}" th:src="${sessionAccount.profileImage}"
                             width="100%" height="100%" class="rounded border"/>
                    </a>
                    <div id="userDropdownMenu" class="dropdown-menu dropdown-menu-right text-center" aria-labelledby="userIconImage">
                        <span id="userNicknameOfUserIcon" class="dropdown-item-text" th:text="${sessionAccount.nickname}"></span>
                        <span id="userIdOfUserIcon" class="dropdown-item-text"  sec:authentication="name"></span>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" th:href="@{'/account/profile-view/' + ${#authentication.name}}">프로필</a>
                        <a class="dropdown-item disabled" th:href="@{#}">내 게시글</a>
                        <a class="dropdown-item" th:href="@{/account/setting/profile}">설정</a>
                        <div class="dropdown-divider"></div>
                        <form class="form-inline" th:action="@{/logout}" method="post">
                            <button class="dropdown-item" type="submit">로그아웃</button>
                        </form>
                    </div>
                </li>
            </ul>
            <form id="mainSearchForm" class="form-inline my-lg-0 order-lg-1 order-md-4 order-4">
                <input class="form-control" type="search" aria-label="Search" placeholder="Search">
                <button id="mainSearchButton" class="btn btn-outline-success my-2 my-sm-0 mr-lg-5" type="submit">검색</button>
            </form>
        </div>
    </nav>

    <div id="emailVerificationAlertMessage" sec:authorize="isAuthenticated()" class="alert alert-warning text-center" role="alert" th:if="${sessionAccount != null && #bools.isFalse(sessionAccount.isEmailVerified())}">
        <a th:href="@{/account/setting/account}" class="alert-link">이메일 인증</a>을 해야 이메일로 비밀번호 찾기, 이메일 알림 등 이메일을 통한 서비스를 받으실 수 있습니다.
    </div>

</div>

<footer th:fragment="commonFooter" class="text-center text-muted" style="margin-top: 32px;margin-bottom: 67px;">
    © 2020 Copyright : taehee.kim.dev@gmail.com
</footer>

<th:block th:fragment="commonJavaScript">
    <script src="/library/jquery/jquery-3.5.1.min.js"></script>
    <script src="/library/bootstrap/bootstrap.bundle.min.js"></script>
    <script src="/library/jdenticon/jdenticon-2.2.0.min.js"></script>
</th:block>

<script type="application/javascript" th:inline="javascript" th:fragment="ajax-csrf-header">
    $(function() {
        var csrfToken = /*[[${_csrf.token}]]*/ null;
        var csrfHeader = /*[[${_csrf.headerName}]]*/ null;
        $(document).ajaxSend(function (e, xhr, options) {
            xhr.setRequestHeader(csrfHeader, csrfToken);
        });
    });
</script>



<div th:fragment="setting-menu (currentMenu)" id="accountSettingMenu" class="list-group text-center">
    <a class="list-group-item list-group-item-action" th:classappend="${currentMenu == 'profile'}? active" th:href="@{/account/setting/profile}">프로필</a>
    <a class="list-group-item list-group-item-action" th:classappend="${currentMenu == 'notification'}? active" th:href="@{/account/setting/notification}">알림</a>
    <a class="list-group-item list-group-item-action" th:classappend="${currentMenu == 'tag'}? active" th:href="@{/account/setting/tag}">관심 태그</a>
    <a class="list-group-item list-group-item-action" th:classappend="${currentMenu == 'password'}? active"th:href="@{/account/setting/password}">패스워드</a>
    <a class="list-group-item list-group-item-action list-group-item-danger" th:classappend="${currentMenu == 'account'}? active" th:href="@{/account/setting/account}">계정</a>
</div>

<div th:fragment="date-time">
    <script src="/library/momentjs/moment-with-locales.min.js"></script>
    <script type="application/javascript">
        $(function () {
            moment.locale('ko');
            $(".date-weekday-time").text(function(index, dateTime) {
                return moment(dateTime, "YYYY-MM-DD`T`hh:mm").format('LLLL');
            });
        })
    </script>
</div>